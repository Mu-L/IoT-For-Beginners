# р░ор▒А р░кр░░р░┐р░Хр░░р░В р░Хр▒Лр░бр▒НтАМр░▓р▒Л X.509 р░╕р░░р▒Нр░Яр░┐р░лр░┐р░Хр▒Зр░Яр▒Н р░Йр░кр░пр▒Лр░Чр░┐р░Вр░Ър░Вр░бр░┐ - р░╡р░░р▒Нр░Ър▒Бр░╡р░▓р▒Н IoT р░╣р░╛р░░р▒Нр░бр▒НтАМр░╡р▒Зр░░р▒Н р░ор░░р░┐р░пр▒Б р░░р░╛р░╕р▒Нр░кр▒Нр░мр▒Жр░░р░┐ р░кр▒И

р░И р░кр░╛р░ар░Вр░▓р▒Л, р░ор▒Ар░░р▒Б р░ор▒А р░╡р░░р▒Нр░Ър▒Бр░╡р░▓р▒Н IoT р░кр░░р░┐р░Хр░░р░╛р░ир▒Нр░ир░┐ р░▓р▒Зр░жр░╛ р░░р░╛р░╕р▒Нр░кр▒Нр░мр▒Жр░░р░┐ р░кр▒Ир░ир░┐ X.509 р░╕р░░р▒Нр░Яр░┐р░лр░┐р░Хр▒Зр░Яр▒Н р░Йр░кр░пр▒Лр░Чр░┐р░Вр░Ър░┐ р░ор▒А IoT р░╣р░мр▒Н р░Хр▒Б р░Хр░ир▒Жр░Хр▒Нр░Яр▒Н р░Ър▒Зр░╕р▒Нр░др░╛р░░р▒Б.

## р░ор▒А р░кр░░р░┐р░Хр░░р░╛р░ир▒Нр░ир░┐ IoT р░╣р░мр▒НтАМр░Хр░┐ р░Хр░ир▒Жр░Хр▒Нр░Яр▒Н р░Ър▒Зр░пр░Вр░бр░┐

р░др░░р▒Нр░╡р░╛р░др░┐ р░жр░╢ р░ор▒А р░кр░░р░┐р░Хр░░р░╛р░ир▒Нр░ир░┐ X.509 р░╕р░░р▒Нр░Яр░┐р░лр░┐р░Хр▒Жр░Яр▒Нр░▓р░ир▒Б р░Йр░кр░пр▒Лр░Чр░┐р░Вр░Ър░┐ IoT р░╣р░мр▒НтАМр░Хр░┐ р░Хр░ир▒Жр░Хр▒Нр░Яр▒Н р░Ър▒Зр░пр░бр░В.

### р░кр░ир░┐ - IoT р░╣р░мр▒НтАМр░Хр▒Б р░Хр░ир▒Жр░Хр▒Нр░Яр▒Н р░Ер░╡р▒Нр░╡р░бр░В

1. р░Хр▒А р░ор░░р░┐р░пр▒Б р░╕р░░р▒Нр░Яр░┐р░лр░┐р░Хр▒Зр░Яр▒Н р░лр▒Ир░│р▒Нр░╕р▒НтАМр░ир▒Б р░ор▒А IoT р░кр░░р░┐р░Хр░░ р░Хр▒Лр░бр▒Н р░Йр░ир▒Нр░и р░лр▒Лр░▓р▒Нр░бр░░р▒НтАМр░Хр▒Б р░Хр░╛р░кр▒А р░Ър▒Зр░пр░Вр░бр░┐. р░ор▒Ар░░р▒Б VS р░Хр▒Лр░бр▒Н р░░р░┐р░ор▒Лр░Яр▒Н SSH р░жр▒Нр░╡р░╛р░░р░╛ р░░р░╛р░╕р▒Нр░кр▒Нр░мр▒Жр░░р░┐ р░кр▒И р░╡р░┐р░ир░┐р░пр▒Лр░Чр░┐р░╕р▒Нр░др▒Бр░Вр░Яр▒З, р░ор░░р░┐р░пр▒Б р░Хр▒Ар░▓р▒Б р░ор▒А PC р░▓р▒Зр░жр░╛ р░ор░╛р░Хр▒НтАМр░▓р▒Л р░╕р▒Гр░╖р▒Нр░Яр░┐р░Вр░Ър░╛р░░р░ир░┐, р░ор▒Ар░░р▒Б р░лр▒Ир░▓р▒Нр░╕р▒НтАМр░ир▒Б VS р░Хр▒Лр░бр▒Н р░Ор░Хр▒Нр░╕р▒НтАМр░кр▒Нр░▓р▒Лр░░р░░р▒НтАМр░▓р▒Лр░Хр░┐ р░бр▒Нр░░р░╛р░Чр▒Н & р░бр▒Нр░░р░╛р░кр▒Н р░Ър▒Зр░╕р░┐ р░Хр░╛р░кр▒А р░Ър▒Зр░пр░╡р░Ър▒Нр░Ър▒Б.

1. `app.py` р░лр▒Ир░▓р▒Н р░др▒Жр░░р░╡р░Вр░бр░┐

1. X.509 р░╕р░░р▒Нр░Яр░┐р░лр░┐р░Хр▒Зр░Яр▒Н р░Йр░кр░пр▒Лр░Чр░┐р░Вр░Ър░┐ р░Хр░ир▒Жр░Хр▒Нр░Яр▒Н р░Хр░╛р░╡р░бр░╛р░ир░┐р░Хр░┐, р░ор▒Ар░Хр▒Б IoT р░╣р░мр▒Н р░пр▒Кр░Хр▒Нр░Х р░╣р▒Лр░╕р▒Нр░Яр▒Н р░кр▒Зр░░р▒Б р░ор░░р░┐р░пр▒Б X.509 р░╕р░░р▒Нр░Яр░┐р░лр░┐р░Хр▒Зр░Яр▒Н р░Ер░╡р░╕р░░р░В. р░кр░░р░┐р░Хр░░ р░Хр▒Нр░▓р░пр░┐р░Вр░Яр▒Н р░╕р▒Гр░╖р▒Нр░Яр░┐р░Вр░Ър▒З р░ор▒Бр░Вр░жр▒Б, р░И р░Хр▒Нр░░р░┐р░Вр░жр░┐ р░Хр▒Лр░бр▒НтАМр░др▒Л р░╣р▒Лр░╕р▒Нр░Яр▒Н р░кр▒Зр░░р▒Б р░Хр░▓р░┐р░Чр░┐р░Вр░Ър▒З р░╡р▒Зр░░р░┐р░пр░мр▒Бр░▓р▒Н р░╕р▒Гр░╖р▒Нр░Яр░┐р░Вр░Ър░бр░В р░кр▒Нр░░р░╛р░░р░Вр░нр░┐р░Вр░Ър░Вр░бр░┐:

    ```python
    host_name = "<host_name>"
    ```

    `<host_name>`р░ир▒Б р░ор▒А IoT р░╣р░мр▒Нр░Хр░┐ р░╣р▒Лр░╕р▒Нр░Яр▒Н р░кр▒Зр░░р▒Бр░др▒Л р░ор░╛р░░р▒Нр░Ър░Вр░бр░┐. р░Зр░жр░┐ `connection_string`р░▓р▒Лр░ир░┐ `HostName` р░╕р▒Жр░Хр▒Нр░╖р░ир▒НтАМ р░ир▒Бр░Вр░бр░┐ р░кр▒Кр░Вр░жр░╡р░Ър▒Нр░Ър▒Б. р░Зр░жр░┐ р░ор▒А IoT р░╣р░мр▒Н р░кр▒Зр░░р▒Б, `.azure-devices.net`р░др▒Л р░ор▒Бр░Чр░┐р░╕р▒З р░Йр░Вр░Яр▒Бр░Вр░жр░┐.

1. р░жр░╛р░ир░┐ р░Хр░┐р░Вр░ж, р░кр░░р░┐р░Хр░░р░В IDр░др▒Л р░╡р▒Зр░░р░┐р░пр░мр▒Бр░▓р▒Н р░кр▒Нр░░р░Хр░Яр░┐р░Вр░Ър░Вр░бр░┐:

    ```python
    device_id = "soil-moisture-sensor-x509"
    ```

1. X.509 р░лр▒Ир░│р▒Нр░▓р▒Б р░Хр░▓р░┐р░Чр░┐ р░Йр░Вр░бр▒З `X509` р░Хр▒Нр░▓р░╛р░╕р▒Н р░пр▒Кр░Хр▒Нр░Х р░Тр░Х р░Зр░ир▒Нр░╕р▒Нр░Яр▒Жр░ир▒Нр░╕р▒Н р░Ер░╡р░╕р░░р░В. `azure.iot.device` р░ор░╛р░бр▒Нр░пр▒Вр░▓р▒Н р░ир▒Бр░Вр░Ър░┐ р░жр░┐р░Чр▒Бр░ор░др░┐ р░др▒Ар░╕р▒Бр░Хр▒Бр░ир▒З р░Хр▒Нр░▓р░╛р░╕р▒НтАМр░▓ р░Ьр░╛р░мр░┐р░др░╛р░▓р▒Л `X509`р░ир░┐ р░Ър▒Зр░░р▒Нр░Ър░Вр░бр░┐:

    ```python
    from azure.iot.device import IoTHubDeviceClient, Message, MethodResponse, X509
    ```

1. р░ор▒А р░╕р░░р▒Нр░Яр░┐р░лр░┐р░Хр▒Зр░Яр▒Н р░ор░░р░┐р░пр▒Б р░Хр▒А р░лр▒Ир░│р▒Нр░╕р▒Н р░Йр░кр░пр▒Лр░Чр░┐р░Вр░Ър░┐ `X509` р░Хр▒Нр░▓р░╛р░╕р▒Н р░Зр░ир▒Нр░╕р▒Нр░Яр▒Жр░ир▒Нр░╕р▒Н р░╕р▒Гр░╖р▒Нр░Яр░┐р░Вр░Ър░Вр░бр░┐, р░И р░Хр░┐р░Вр░ж р░Зр░Ър▒Нр░Ър░┐р░и р░Хр▒Лр░бр▒НтАМр░ир▒Б `host_name` р░кр▒Нр░░тАМр░ХтАМр░ЯтАМр░и р░Хр░┐р░Вр░ж р░Ър▒Зр░░р▒Нр░Ър░Вр░бр░┐:

    ```python
    x509 = X509("./soil-moisture-sensor-x509-cert.pem", "./soil-moisture-sensor-x509-key.pem")
    ```

    р░Зр░жр░┐ р░ор▒Бр░Вр░жр▒Бр░Чр░╛ р░╕р▒Гр░╖р▒Нр░Яр░┐р░Вр░Ър░┐р░и `soil-moisture-sensor-x509-cert.pem` р░ор░░р░┐р░пр▒Б `soil-moisture-sensor-x509-key.pem` р░лр▒Ир░│р▒Нр░▓р░др▒Л `X509` р░Хр▒Нр░▓р░╛р░╕р▒Н р░╕р▒Гр░╖р▒Нр░Яр░┐р░╕р▒Нр░др▒Бр░Вр░жр░┐.

1. р░Хр░ир▒Жр░Хр▒Нр░╖р░ир▒Н р░╕р╡Нр┤Яр▒Нр░░р░┐р░Вр░Чр▒Н р░Жр░зр░╛р░░р░Вр░Чр░╛ `device_client` р░╕р▒Гр░╖р▒Нр░Яр░┐р░Вр░Ър▒З р░Хр▒Лр░бр▒Н р░▓р▒Ир░ир▒Бр░ир▒Б р░И р░Хр▒Нр░░р░┐р░Вр░жр░┐ р░Хр▒Лр░бр▒НтАМр░др▒Л р░ор░╛р░░р▒Нр░Ър░Вр░бр░┐:

    ```python
    device_client = IoTHubDeviceClient.create_from_x509_certificate(x509, host_name, device_id)
    ```

    р░Зр░жр░┐ р░Хр░ир▒Жр░Хр▒Нр░╖р░ир▒Н р░╕р▒Нр░др▒Нр░░р░┐р░Вр░Чр▒Н р░Хр░╛р░Хр▒Бр░Вр░бр░╛ X.509 р░╕р░░р▒Нр░Яр░┐р░лр░┐р░Хр▒Жр░Яр▒Н р░Йр░кр░пр▒Лр░Чр░┐р░Вр░Ър░┐ р░Хр░ир▒Жр░Хр▒Нр░Яр▒Н р░Ър▒Зр░╕р▒Нр░др▒Бр░Вр░жр░┐.
    
1. `connection_string` р░╡р▒Зр░░р░┐р░пр░мр▒Бр░▓р▒Н р░Йр░Вр░бр▒З р░▓р▒Ир░ир▒НтАМр░ир▒Б р░др▒Ар░╕р░┐р░╡р▒Зр░пр░Вр░бр░┐.

1. р░ор▒А р░Хр▒Лр░бр▒НтАМр░ир▒Б р░Ер░отАМр░▓р▒Б р░Ър▒Зр░пр░Вр░бр░┐. IoT р░╣р░мр▒НтАМр░Хр▒Б р░кр░Вр░кр▒Бр░др▒Бр░ир▒Нр░и р░╕р░Вр░жр▒Зр░╢р░╛р░▓р░ир▒Б р░кр░░р▒Нр░пр░╡р▒Зр░Хр▒Нр░╖р░┐р░Вр░Ър░Вр░бр░┐, р░ор░░р░┐р░пр▒Б р░ор▒Бр░ир▒Бр░кр░Яр░┐р░▓р░╛р░Чр▒З р░бр▒Ир░░р▒Жр░Хр▒Нр░Яр▒Н р░ор▒Жр░ер░бр▒Н р░Ер░нр▒Нр░пр░░р▒Нр░зр░ир░▓р▒Б р░кр░Вр░кр░Вр░бр░┐. р░ор▒Ар░░р▒Б р░кр░░р░┐р░Хр░░р░В р░Хр░ир▒Жр░Хр▒Нр░Яр▒Н р░Ер░╡р▒Бр░др▒В р░ор░Яр▒Нр░Яр░┐ р░др▒Зр░о р░Хр▒Кр░▓р░др░▓р░ир▒Б р░кр░Вр░кр▒Бр░др▒Бр░Вр░жр░┐, р░Ер░▓р░╛р░Чр▒З р░бр▒Ир░░р▒Жр░Хр▒Нр░Яр▒Н р░ор▒Жр░ер░бр▒Н р░Ер░нр▒Нр░пр░░р▒Нр░зр░ир░▓р░ир▒Б р░╕р▒Нр░╡р▒Ар░Хр░░р░┐р░╕р▒Нр░др▒Бр░Вр░жр░┐.

> ЁЯТБ р░ор▒Ар░░р▒Б р░И р░Хр▒Лр░бр▒НтАМр░ир▒Б [code/pi](../../../../../2-farm/lessons/6-keep-your-plant-secure/code/pi) р░▓р▒Зр░жр░╛ [code/virtual-device](../../../../../2-farm/lessons/6-keep-your-plant-secure/code/virtual-device) р░лр▒Лр░▓р▒Нр░бр░░р▒НтАМр░▓р▒Л р░Хр░ир▒Бр░Чр▒Кр░ир░╡р░Ър▒Нр░Ър▒Б.

ЁЯША р░ор▒А р░ор░Яр▒Нр░Яр░┐ р░др▒Зр░о р░╕р▒Жр░ир▒Нр░╕р░╛р░░р▒Н р░кр▒Нр░░р▒Лр░Чр▒Нр░░р░╛р░ор▒Н X.509 р░╕р░░р▒Нр░Яр░┐р░лр░┐р░Хр▒Зр░Яр▒Н р░Йр░кр░пр▒Лр░Чр░┐р░Вр░Ър░┐ р░ор▒А IoT р░╣р░мр▒НтАМр░Хр▒Б р░Хр░ир▒Жр░Хр▒Нр░Яр▒Н р░Ер░пр░┐р░Вр░жр░┐!

---

<!-- CO-OP TRANSLATOR DISCLAIMER START -->
**р░Ер░╕р▒Нр░кр░╖р▒Нр░Яр░д**:  
р░И р░кр░др▒Нр░░р░╛р░ир▒Нр░ир░┐ AI р░Ер░ир▒Бр░╡р░╛р░ж р░╕р▒Зр░╡ [Co-op Translator](https://github.com/Azure/co-op-translator) р░Йр░кр░пр▒Лр░Чр░┐р░Вр░Ър░┐ р░Ер░ир▒Бр░╡р░жр░┐р░Вр░Ър░мр░бр░┐р░Вр░жр░┐. р░ор▒Зр░ор▒Б р░ир░╛р░гр▒Нр░пр░др░Хр▒Б р░кр▒Нр░░р░пр░др▒Нр░ир░┐р░╕р▒Нр░др▒Бр░ир▒Нр░ир░кр▒Нр░кр░Яр░┐р░Хр▒А, р░╕р▒Нр░╡р░пр░Вр░Ър░╛р░▓р░Х р░Ер░ир▒Бр░╡р░╛р░жр░╛р░▓р▒Нр░▓р▒Л р░др░кр▒Нр░кр▒Бр░▓р▒Б р░▓р▒Зр░жр░╛ р░Ер░кр▒Вр░░р▒Нр░╡р░др░▓р▒Б р░Йр░Вр░бр░╡р░Ър▒Нр░Ър▒Б р░Ер░ир░┐ р░жр░пр░Ър▒Зр░╕р░┐ р░Чр▒Бр░░р▒Нр░др▒Бр░Вр░Ър▒Бр░Хр▒Лр░Вр░бр░┐. р░╕р▒Нр░╡р░др░Вр░др▒Нр░░ р░нр░╛р░╖р░▓р▒Л р░Йр░ир▒Нр░и р░ор▒Вр░▓ р░кр░др▒Нр░░р░╛р░ир▒Нр░ир░┐ р░Ер░зр░┐р░Хр░╛р░░р░В р░Хр░▓р░┐р░Чр░┐р░и р░ор▒Вр░▓р░Вр░Чр░╛ р░кр░░р░┐р░Чр░гр░┐р░Вр░Ър░╛р░▓р░┐. р░ор▒Бр░Цр▒Нр░пр░ор▒Ир░и р░╕р░ор░╛р░Ър░╛р░░р░В р░Хр▒Лр░╕р░В, р░кр▒Нр░░р▒Кр░лр▒Жр░╖р░ир░▓р▒Н р░ор░╛р░ир░╡ р░Ер░ир▒Бр░╡р░╛р░жр░╛р░ир▒Нр░ир░┐ р░╕р░▓р░╣р░╛ р░Зр░╕р▒Нр░др▒Бр░ир▒Нр░ир░╛р░ор▒Б. р░И р░Ер░ир▒Бр░╡р░╛р░жр░В р░Йр░кр░пр▒Лр░Чр░Вр░др▒Л р░╡р░Ър▒Нр░Ър▒З р░Пр░жр▒Ир░ир░╛ р░кр▒Кр░░р░кр░╛р░Яр▒Б р░▓р▒Зр░жр░╛ р░др░кр▒Нр░кр▒Бр░мр░╛р░Яр▒Бр░Хр▒Б р░ор▒Зр░ор▒Б р░мр░╛р░зр▒Нр░пр▒Бр░▓р▒Б р░Хр░╛р░жр░ир░┐ р░др▒Жр░▓р░┐р░пр░Ьр▒Зр░╕р▒Нр░др▒Бр░ир▒Нр░ир░╛р░ор▒Б.
<!-- CO-OP TRANSLATOR DISCLAIMER END -->