# ‡∞Æ‡±Ä IoT ‡∞°‡∞ø‡∞µ‡±à‡∞∏‡±ç‚Äå‡∞®‡±Å ‡∞ï‡±ç‡∞≤‡±å‡∞°‡±ç ‡∞ï‡±Å ‡∞ï‡∞®‡±Ü‡∞ï‡±ç‡∞ü‡±ç ‡∞ö‡±Ü‡∞Ø‡±ç‡∞Ø‡∞Ç‡∞°‡∞ø - ‡∞µ‡∞∞‡±ç‡∞ö‡±Å‡∞µ‡∞≤‡±ç IoT ‡∞π‡∞æ‡∞∞‡±ç‡∞°‡±ç‡∞µ‡±á‡∞∞‡±ç ‡∞Æ‡∞∞‡∞ø‡∞Ø‡±Å ‡∞∞‡∞æ‡∞∏‡±ç‡∞™‡±ç‡∞¨‡±Ü‡∞∞‡±Ä ‡∞™‡∞ø

‡∞à ‡∞™‡∞æ‡∞†‡∞Ç‡∞≤‡±ã, ‡∞Æ‡±Ä‡∞∞‡±Å ‡∞Æ‡±Ä ‡∞µ‡∞∞‡±ç‡∞ö‡±Å‡∞µ‡∞≤‡±ç IoT ‡∞°‡∞ø‡∞µ‡±à‡∞∏‡±ç ‡∞≤‡±á‡∞¶‡∞æ ‡∞∞‡∞æ‡∞∏‡±ç‡∞™‡±ç‡∞¨‡±Ü‡∞∞‡±Ä ‡∞™‡∞ø‚Äå‡∞®‡±Å ‡∞Æ‡±Ä IoT ‡∞π‡∞¨‡±ç ‡∞ï‡±Å ‡∞ï‡∞®‡±Ü‡∞ï‡±ç‡∞ü‡±ç ‡∞ö‡±á‡∞∏‡∞ø, ‡∞ü‡±Ü‡∞≤‡∞ø‡∞Æ‡±Ü‡∞ü‡±ç‡∞∞‡±Ä ‡∞™‡∞Ç‡∞™‡∞°‡∞Ç ‡∞Æ‡∞∞‡∞ø‡∞Ø‡±Å ‡∞Ü‡∞¶‡±á‡∞∂‡∞æ‡∞≤‡±Å ‡∞∏‡±ç‡∞µ‡±Ä‡∞ï‡∞∞‡∞ø‡∞Ç‡∞ö‡∞°‡∞æ‡∞®‡±ç‡∞®‡∞ø ‡∞®‡±á‡∞∞‡±ç‡∞ö‡±Å‡∞ï‡±Å‡∞Ç‡∞ü‡∞æ‡∞∞‡±Å.

## ‡∞Æ‡±Ä ‡∞°‡∞ø‡∞µ‡±à‡∞∏‡±ç‚Äå‡∞®‡±Å IoT ‡∞π‡∞¨‡±ç‚Äå‡∞ï‡±Å ‡∞ï‡∞®‡±Ü‡∞ï‡±ç‡∞ü‡±ç ‡∞ö‡±á‡∞Ø‡∞Ç‡∞°‡∞ø

‡∞§‡∞∞‡±ç‡∞µ‡∞æ‡∞§‡∞ø ‡∞Ö‡∞°‡±Å‡∞ó‡±Å ‡∞Æ‡±Ä ‡∞°‡∞ø‡∞µ‡±à‡∞∏‡±ç‚Äå‡∞®‡±Å IoT ‡∞π‡∞¨‡±ç ‡∞ï‡±Å ‡∞ï‡∞®‡±Ü‡∞ï‡±ç‡∞ü‡±ç ‡∞ö‡±á‡∞Ø‡∞°‡∞Ç.

### ‡∞ü‡∞æ‡∞∏‡±ç‡∞ï‡±ç - IoT ‡∞π‡∞¨‡±ç‚Äå‡∞ï‡±Å ‡∞ï‡∞®‡±Ü‡∞ï‡±ç‡∞ü‡±ç ‡∞Ö‡∞µ‡±ç‡∞µ‡∞Ç‡∞°‡∞ø

1. VS ‡∞ï‡±ã‡∞°‡±ç‚Äå‡∞≤‡±ã `soil-moisture-sensor` ‡∞´‡±ã‡∞≤‡±ç‡∞°‡∞∞‡±ç ‡∞®‡±Å ‡∞§‡±Ü‡∞∞‡∞µ‡∞Ç‡∞°‡∞ø. ‡∞Æ‡±Ä‡∞∞‡±Å ‡∞µ‡∞∞‡±ç‡∞ö‡±Å‡∞µ‡∞≤‡±ç IoT ‡∞°‡∞ø‡∞µ‡±à‡∞∏‡±ç ‡∞â‡∞™‡∞Ø‡±ã‡∞ó‡∞ø‡∞∏‡±ç‡∞§‡±Å‡∞®‡∞ü‡±ç‡∞≤‡∞Ø‡∞ø‡∞§‡±á, ‡∞ü‡±Ü‡∞∞‡±ç‡∞Æ‡∞ø‡∞®‡∞≤‡±ç‚Äå‡∞≤‡±ã ‡∞µ‡∞∞‡±ç‡∞ö‡±Å‡∞µ‡∞≤‡±ç ‡∞é‡∞®‡±ç‡∞µ‡∞ø‡∞∞‡∞æ‡∞®‡±ç‚Äå‡∞Æ‡±Ü‡∞Ç‡∞ü‡±ç ‡∞®‡∞°‡±Å‡∞∏‡±ç‡∞§‡±Å‡∞®‡±ç‡∞®‡∞¶‡∞®‡∞ø ‡∞®‡∞ø‡∞∞‡±ç‡∞ß‡∞æ‡∞∞‡∞ø‡∞Ç‡∞ö‡±Å‡∞ï‡±ã‡∞Ç‡∞°‡∞ø.

1. ‡∞ï‡±ä‡∞®‡±ç‡∞®‡∞ø ‡∞Ö‡∞¶‡∞®‡∞™‡±Å ‡∞™‡∞ø‡∞™‡±ç ‡∞™‡±ç‡∞Ø‡∞æ‡∞ï‡±á‡∞ú‡∞ø‡∞≤‡∞®‡±Å ‡∞á‡∞®‡±ç ‡∞∏‡±ç‡∞ü‡∞æ‡∞≤‡±ç ‡∞ö‡±á‡∞Ø‡∞Ç‡∞°‡∞ø:

    ```sh
    pip3 install azure-iot-device
    ```

    `azure-iot-device` ‡∞Ö‡∞®‡±á‡∞¶‡∞ø ‡∞Æ‡±Ä IoT ‡∞π‡∞¨‡±ç ‡∞§‡±ã ‡∞ï‡∞Æ‡±ç‡∞Ø‡±Ç‡∞®‡∞ø‡∞ï‡±á‡∞ü‡±ç ‡∞ö‡±á‡∞∏‡±á‡∞Ç‡∞¶‡±Å‡∞ï‡±Å ‡∞â‡∞™‡∞Ø‡±ã‡∞ó‡∞ø‡∞Ç‡∞ö‡±á ‡∞≤‡±à‡∞¨‡±ç‡∞∞‡∞∞‡±Ä.

1. `app.py` ‡∞´‡±à‡∞≤‡±ç ‡∞ü‡∞æ‡∞™‡±ç‚Äå‡∞≤‡±ã, ‡∞ú‡±á‡∞§‡±ç ‡∞â‡∞®‡±ç‡∞® ‡∞á‡∞Ç‡∞™‡±ã‡∞∞‡±ç‡∞ü‡±Å‡∞≤ ‡∞ï‡∞ø‡∞Ç‡∞¶, ‡∞ï‡±ç‡∞∞‡∞ø‡∞Ç‡∞¶‡∞ø ‡∞á‡∞Ç‡∞™‡±ã‡∞∞‡±ç‡∞ü‡±Å‡∞≤‡±Å ‡∞ú‡±ã‡∞°‡∞ø‡∞Ç‡∞ö‡∞Ç‡∞°‡∞ø:

    ```python
    from azure.iot.device import IoTHubDeviceClient, Message, MethodResponse
    ```

    ‡∞à ‡∞ï‡±ã‡∞°‡±ç ‡∞Æ‡±Ä IoT ‡∞π‡∞¨‡±ç ‡∞§‡±ã ‡∞ï‡∞Æ‡±ç‡∞Ø‡±Ç‡∞®‡∞ø‡∞ï‡±á‡∞ü‡±ç ‡∞ö‡±á‡∞Ø‡∞°‡∞æ‡∞®‡∞ø‡∞ï‡∞ø SDK‡∞®‡∞ø ‡∞á‡∞Ç‡∞™‡±ã‡∞∞‡±ç‡∞ü‡±ç ‡∞ö‡±á‡∞∏‡±ç‡∞§‡±Å‡∞Ç‡∞¶‡∞ø.

1. `import paho.mqtt.client as mqtt` ‡∞≤‡±à‡∞®‡±ç ‡∞§‡±Ä‡∞∏‡∞ø‡∞µ‡±á‡∞Ø‡∞Ç‡∞°‡∞ø, ‡∞é‡∞Ç‡∞¶‡±Å‡∞ï‡∞Ç‡∞ü‡±á ‡∞à ‡∞≤‡±à‡∞¨‡±ç‡∞∞‡∞∞‡±Ä ‡∞á‡∞ï ‡∞Ö‡∞µ‡∞∏‡∞∞‡∞Ç ‡∞≤‡±á‡∞¶‡±Å. MQTT ‡∞ï‡±ã‡∞°‡±ç ‡∞®‡±Å, ‡∞ü‡∞æ‡∞™‡∞ø‡∞ï‡±ç ‡∞®‡±á‡∞Æ‡±ç‡∞∏‡±ç ‡∞∏‡∞π‡∞æ, `mqtt_client` ‡∞â‡∞™‡∞Ø‡±ã‡∞ó‡∞ø‡∞Ç‡∞ö‡±á ‡∞Ö‡∞®‡±ç‡∞®‡∞ø ‡∞ï‡±ã‡∞°‡±ç, ‡∞Æ‡∞∞‡∞ø‡∞Ø‡±Å `handle_command` ‡∞®‡±Å ‡∞§‡±Ä‡∞∏‡∞ø‡∞µ‡±á‡∞Ø‡∞Ç‡∞°‡∞ø. `while True:` ‡∞≤‡±Ç‡∞™‡±ç ‡∞®‡∞ø‡∞≤‡±Å‡∞™‡±Å‡∞ï‡±ã‡∞Ç‡∞°‡∞ø, ‡∞ï‡±á‡∞µ‡∞≤‡∞Ç `mqtt_client.publish` ‡∞≤‡±à‡∞®‡±ç ‡∞à ‡∞≤‡±Ç‡∞™‡±ç ‡∞®‡±Å‡∞Ç‡∞°‡∞ø ‡∞§‡±ä‡∞≤‡∞ó‡∞ø‡∞Ç‡∞ö‡∞Ç‡∞°‡∞ø.

1. ‡∞á‡∞Ç‡∞™‡±ã‡∞∞‡±ç‡∞ü‡±ç ‡∞∏‡±ç‡∞ü‡±á‡∞ü‡±ç‡∞Æ‡±Ü‡∞Ç‡∞ü‡±ç‡∞∏‡±ç ‡∞ï‡∞ø‡∞Ç‡∞¶ ‡∞ï‡±ç‡∞∞‡∞ø‡∞Ç‡∞¶‡∞ø ‡∞ï‡±ã‡∞°‡±ç‡∞®‡±Å ‡∞ú‡±ã‡∞°‡∞ø‡∞Ç‡∞ö‡∞Ç‡∞°‡∞ø:

    ```python
    connection_string = "<connection string>"
    ```

    `<connection string>` ‡∞®‡±Å ‡∞Æ‡±Ä‡∞∞‡±Å ‡∞à ‡∞™‡∞æ‡∞†‡∞Ç‡∞≤‡±ã ‡∞Æ‡±Å‡∞Ç‡∞¶‡±Å‡∞ó‡∞æ ‡∞™‡±ä‡∞Ç‡∞¶‡∞ø‡∞® ‡∞°‡∞ø‡∞µ‡±à‡∞∏‡±ç ‡∞ï‡∞®‡±Ü‡∞ï‡±ç‡∞∑‡∞®‡±ç ‡∞∏‡±ç‡∞ü‡±ç‡∞∞‡∞ø‡∞Ç‡∞ó‡±ç ‡∞§‡±ã ‡∞Æ‡∞æ‡∞∞‡±ç‡∞ö‡∞Ç‡∞°‡∞ø.

    > üíÅ ‡∞á‡∞¶‡∞ø ‡∞â‡∞§‡±ç‡∞§‡∞Æ ‡∞™‡∞¶‡±ç‡∞ß‡∞§‡∞ø ‡∞ï‡∞æ‡∞¶‡±Å. ‡∞ï‡∞®‡±Ü‡∞ï‡±ç‡∞∑‡∞®‡±ç ‡∞∏‡±ç‡∞ü‡±ç‡∞∞‡∞ø‡∞Ç‡∞ó‡±ç ‡∞≤‡∞®‡±Å ‡∞é‡∞™‡±ç‡∞™‡±Å‡∞°‡±Ç ‡∞∏‡±ã‡∞∞‡±ç‡∞∏‡±ç ‡∞ï‡±ã‡∞°‡±ç ‡∞≤‡±ã ‡∞®‡∞ø‡∞≤‡±ç‡∞µ ‡∞ö‡±á‡∞Ø‡∞ï‡±Ç‡∞°‡∞¶‡±Å, ‡∞é‡∞Ç‡∞¶‡±Å‡∞ï‡∞Ç‡∞ü‡±á ‡∞á‡∞¶‡∞ø ‡∞∏‡±ã‡∞∞‡±ç‡∞∏‡±ç ‡∞ï‡±ã‡∞°‡±ç ‡∞ï‡∞Ç‡∞ü‡±ç‡∞∞‡±ã‡∞≤‡±ç ‡∞≤‡±ã ‡∞ö‡±Ü‡∞ï‡±ç ‡∞á‡∞®‡±ç ‡∞Ö‡∞Ø‡±ç‡∞Ø‡∞ø ‡∞é‡∞µ‡∞∞‡∞ø‡∞ï‡±à‡∞®‡∞æ ‡∞ï‡∞®‡∞ø‡∞™‡∞ø‡∞Ç‡∞ö‡∞µ‡∞ö‡±ç‡∞ö‡±Å. ‡∞à ‡∞∏‡±Å‡∞≤‡∞≠‡∞§ ‡∞ï‡±ã‡∞∏‡∞Ç ‡∞á‡∞ï‡±ç‡∞ï‡∞° ‡∞Æ‡∞®‡∞Ç ‡∞á‡∞¶‡∞ø ‡∞ö‡±á‡∞∏‡±ç‡∞§‡±Å‡∞®‡±ç‡∞®‡∞æ‡∞Æ‡±Å. ‡∞ê‡∞°‡∞ø‡∞Ø‡∞≤‡±ç ‡∞ó‡∞æ ‡∞Æ‡±Ä‡∞∞‡±Å ‡∞í‡∞ïenvironment variable ‡∞Æ‡∞∞‡∞ø‡∞Ø‡±Å [`python-dotenv`](https://pypi.org/project/python-dotenv/) ‡∞≤‡∞æ‡∞Ç‡∞ü‡∞ø ‡∞ü‡±Ç‡∞≤‡±ç ‡∞â‡∞™‡∞Ø‡±ã‡∞ó‡∞ø‡∞Ç‡∞ö‡∞æ‡∞≤‡∞ø. ‡∞Æ‡∞ø‡∞Æ‡±ç‡∞Æ‡∞≤‡±ç‡∞®‡∞ø ‡∞§‡∞¶‡±Å‡∞™‡∞∞‡∞ø ‡∞™‡∞æ‡∞†‡∞Ç‡∞≤‡±ã ‡∞à ‡∞µ‡∞ø‡∞∑‡∞Ø‡∞Ç ‡∞™‡±à ‡∞Æ‡∞∞‡∞ø‡∞Ç‡∞§ ‡∞®‡±á‡∞∞‡±ç‡∞™‡∞¨‡∞°‡∞§‡∞æ‡∞∞‡±Å.

1. ‡∞à ‡∞ï‡±ã‡∞°‡±ç ‡∞ï‡∞ø‡∞Ç‡∞¶ ‡∞ï‡±ç‡∞∞‡∞ø‡∞Ç‡∞¶‡∞ø ‡∞ï‡±ã‡∞°‡±ç ‡∞®‡±Å ‡∞ú‡±ã‡∞°‡∞ø‡∞Ç‡∞ö‡∞ø IoT ‡∞π‡∞¨‡±ç ‡∞§‡±ã ‡∞ï‡∞Æ‡±ç‡∞Ø‡±Ç‡∞®‡∞ø‡∞ï‡±á‡∞ü‡±ç ‡∞ö‡±á‡∞Ø‡∞ó‡∞≤‡∞ø‡∞ó‡±á ‡∞°‡∞ø‡∞µ‡±à‡∞∏‡±ç ‡∞ï‡±ç‡∞≤‡±à‡∞Ç‡∞ü‡±ç ‡∞Ü‡∞¨‡±ç‡∞ú‡±Ü‡∞ï‡±ç‡∞ü‡±ç ‡∞∏‡±É‡∞∑‡±ç‡∞ü‡∞ø‡∞Ç‡∞ö‡∞ø, ‡∞ï‡∞®‡±Ü‡∞ï‡±ç‡∞ü‡±ç ‡∞ö‡±á‡∞Ø‡∞Ç‡∞°‡∞ø:

    ```python
    device_client = IoTHubDeviceClient.create_from_connection_string(connection_string)

    print('Connecting')
    device_client.connect()
    print('Connected')
    ```

1. ‡∞à ‡∞ï‡±ã‡∞°‡±ç ‡∞®‡±Å ‡∞∞‡∞®‡±ç ‡∞ö‡±á‡∞Ø‡∞Ç‡∞°‡∞ø. ‡∞Æ‡±Ä ‡∞°‡∞ø‡∞µ‡±à‡∞∏‡±ç ‡∞ï‡∞®‡±Ü‡∞ï‡±ç‡∞ü‡±ç ‡∞Ö‡∞Ø‡∞ø‡∞®‡∞ü‡±ç‡∞≤‡±Å ‡∞Æ‡±Ä‡∞∞‡±Å ‡∞ö‡±Ç‡∞°‡∞ó‡∞≤‡∞∞‡∞®‡∞ø.

    ```output
    pi@raspberrypi:~/soil-moisture-sensor $ python3 app.py 
    Connecting
    Connected
    Soil moisture: 379
    ```

## ‡∞ü‡±Ü‡∞≤‡∞ø‡∞Æ‡±Ü‡∞ü‡±ç‡∞∞‡±Ä ‡∞™‡∞Ç‡∞™‡∞Ç‡∞°‡∞ø

‡∞á‡∞™‡±ç‡∞™‡±Å‡∞°‡±Å ‡∞Æ‡±Ä ‡∞°‡∞ø‡∞µ‡±à‡∞∏‡±ç ‡∞ï‡∞®‡±Ü‡∞ï‡±ç‡∞ü‡±ç ‡∞Ö‡∞Ø‡∞ø‡∞®‡∞Ç‡∞¶‡±Å‡∞®, ‡∞Æ‡±Ä‡∞∞‡±Å MQTT ‡∞¨‡±ç‡∞∞‡±ã‡∞ï‡∞∞‡±ç ‡∞ï‡∞ø ‡∞¨‡∞¶‡±Å‡∞≤‡±Å IoT ‡∞π‡∞¨‡±ç ‡∞ï‡∞ø ‡∞ü‡±Ü‡∞≤‡∞ø‡∞Æ‡±Ü‡∞ü‡±ç‡∞∞‡±Ä ‡∞™‡∞Ç‡∞™‡∞µ‡∞ö‡±ç‡∞ö‡±Å.

### ‡∞ü‡∞æ‡∞∏‡±ç‡∞ï‡±ç - ‡∞ü‡±Ü‡∞≤‡∞ø‡∞Æ‡±Ü‡∞ü‡±ç‡∞∞‡±Ä ‡∞™‡∞Ç‡∞™‡∞Ç‡∞°‡∞ø

1. `while True` ‡∞≤‡±Ç‡∞™‡±ç ‡∞≤‡±ã, `sleep` ‡∞Æ‡±Å‡∞Ç‡∞¶‡±Å ‡∞ï‡±ç‡∞∞‡∞ø‡∞Ç‡∞¶‡∞ø ‡∞ï‡±ã‡∞°‡±ç‚Äå‡∞®‡±Å ‡∞ú‡±ã‡∞°‡∞ø‡∞Ç‡∞ö‡∞Ç‡∞°‡∞ø:

    ```python
    message = Message(json.dumps({ 'soil_moisture': soil_moisture }))
    device_client.send_message(message)
    ```

    ‡∞à ‡∞ï‡±ã‡∞°‡±ç IoT ‡∞π‡∞¨‡±ç `Message` ‡∞®‡±Å ‡∞ï‡±ç‡∞∞‡∞ø‡∞Ø‡±á‡∞ü‡±ç ‡∞ö‡±á‡∞∏‡±ç‡∞§‡±Å‡∞Ç‡∞¶‡∞ø, ‡∞á‡∞¶‡∞ø JSON ‡∞∏‡±ç‡∞ü‡±ç‡∞∞‡∞ø‡∞Ç‡∞ó‡±ç ‡∞ó‡∞æ ‡∞Æ‡∞ü‡±ç‡∞ü‡∞ø‡∞≤‡±ã ‡∞§‡±á‡∞Æ ‡∞â‡∞ö‡±ç‡∞ö‡∞ø‡∞ï‡∞®‡±Å ‡∞ï‡∞≤‡∞ø‡∞ó‡∞ø ‡∞â‡∞Ç‡∞ü‡±Å‡∞Ç‡∞¶‡∞ø, ‡∞§‡∞¶‡±ç‡∞µ‡∞æ‡∞∞‡∞æ ‡∞á‡∞¶‡∞ø ‡∞°‡∞ø‡∞µ‡±à‡∞∏‡±ç-‡∞ü‡±Å-‡∞ï‡±ç‡∞≤‡±å‡∞°‡±ç ‡∞∏‡∞Ç‡∞¶‡±á‡∞∂‡∞Ç‡∞ó‡∞æ IoT ‡∞π‡∞¨‡±ç ‡∞ï‡∞ø ‡∞™‡∞Ç‡∞™‡∞¨‡∞°‡±Å‡∞§‡±Å‡∞Ç‡∞¶‡∞ø.

## ‡∞Ü‡∞¶‡±á‡∞∂‡∞æ‡∞≤‡±Å ‡∞π‡±ç‡∞Ø‡∞æ‡∞Ç‡∞°‡∞ø‡∞≤‡±ç ‡∞ö‡±á‡∞Ø‡∞Ç‡∞°‡∞ø

‡∞Æ‡±Ä ‡∞°‡∞ø‡∞µ‡±à‡∞∏‡±ç ‡∞ï‡∞ø ‡∞∞‡±Ä‡∞≤‡±á ‡∞®‡∞ø‡∞Ø‡∞Ç‡∞§‡±ç‡∞∞‡∞ø‡∞Ç‡∞ö‡±á‡∞Ç‡∞¶‡±Å‡∞ï‡±Å ‡∞∏‡∞∞‡±ç‡∞µ‡∞∞‡±ç ‡∞ï‡±ã‡∞°‡±ç ‡∞®‡±Å‡∞Ç‡∞ö‡∞ø ‡∞µ‡∞ö‡±ç‡∞ö‡±á ‡∞Ü‡∞¶‡±á‡∞∂‡∞æ‡∞®‡±ç‡∞®‡∞ø ‡∞π‡±ç‡∞Ø‡∞æ‡∞Ç‡∞°‡∞ø‡∞≤‡±ç ‡∞ö‡±á‡∞Ø‡∞æ‡∞≤‡∞ø. ‡∞á‡∞¶‡∞ø ‡∞°‡±à‡∞∞‡±Ü‡∞ï‡±ç‡∞ü‡±ç ‡∞Æ‡±Ü‡∞•‡∞°‡±ç ‡∞∞‡∞ø‡∞ï‡±ç‡∞µ‡±Ü‡∞∏‡±ç‡∞ü‡±ç ‡∞ó‡∞æ ‡∞™‡∞Ç‡∞™‡∞¨‡∞°‡±Å‡∞§‡±Å‡∞Ç‡∞¶‡∞ø.

## ‡∞ü‡∞æ‡∞∏‡±ç‡∞ï‡±ç - ‡∞°‡±à‡∞∞‡±Ü‡∞ï‡±ç‡∞ü‡±ç ‡∞Æ‡±Ü‡∞•‡∞°‡±ç ‡∞∞‡∞ø‡∞ï‡±ç‡∞µ‡±Ü‡∞∏‡±ç‡∞ü‡±ç ‡∞®‡±Å ‡∞π‡±ç‡∞Ø‡∞æ‡∞Ç‡∞°‡∞ø‡∞≤‡±ç ‡∞ö‡±á‡∞Ø‡∞Ç‡∞°‡∞ø

1. `while True` ‡∞≤‡±Ç‡∞™‡±ç ‡∞Æ‡±Å‡∞Ç‡∞¶‡±Å ‡∞ï‡±ç‡∞∞‡∞ø‡∞Ç‡∞¶‡∞ø ‡∞ï‡±ã‡∞°‡±ç ‡∞ú‡±ã‡∞°‡∞ø‡∞Ç‡∞ö‡∞Ç‡∞°‡∞ø:

    ```python
    def handle_method_request(request):
        print("Direct method received - ", request.name)
    
        if request.name == "relay_on":
            relay.on()
        elif request.name == "relay_off":
            relay.off()    
    ```

    ‡∞á‡∞¶‡∞ø `handle_method_request` ‡∞Ö‡∞®‡±á ‡∞í‡∞ï ‡∞Æ‡±Ü‡∞•‡∞°‡±ç ‡∞®‡∞ø‡∞∞‡±ç‡∞µ‡∞ö‡∞ø‡∞∏‡±ç‡∞§‡±Å‡∞Ç‡∞¶‡∞ø, ‡∞á‡∞¶‡∞ø IoT ‡∞π‡∞¨‡±ç ‡∞¶‡±ç‡∞µ‡∞æ‡∞∞‡∞æ ‡∞°‡±à‡∞∞‡±Ü‡∞ï‡±ç‡∞ü‡±ç ‡∞Æ‡±Ü‡∞•‡∞°‡±ç ‡∞™‡∞ø‡∞≤‡∞µ‡∞¨‡∞°‡∞ø‡∞®‡∞™‡±ç‡∞™‡±Å‡∞°‡±Å ‡∞ï‡∞æ‡∞≤‡±ç ‡∞Ö‡∞µ‡±Å‡∞§‡±Å‡∞Ç‡∞¶‡∞ø. ‡∞™‡±ç‡∞∞‡∞§‡∞ø ‡∞°‡±à‡∞∞‡±Ü‡∞ï‡±ç‡∞ü‡±ç ‡∞Æ‡±Ü‡∞•‡∞°‡±ç ‡∞ï‡∞ø ‡∞í‡∞ï ‡∞™‡±á‡∞∞‡±Å ‡∞â‡∞Ç‡∞ü‡±Å‡∞Ç‡∞¶‡∞ø, ‡∞à ‡∞ï‡±ã‡∞°‡±ç `relay_on` ‡∞Ö‡∞®‡±á ‡∞Æ‡±Ü‡∞•‡∞°‡±ç ‡∞§‡±ã ‡∞∞‡±Ä‡∞≤‡±á‡∞®‡∞ø ‡∞Ü‡∞®‡±ç ‡∞ö‡±á‡∞Ø‡∞°‡∞æ‡∞®‡∞ø‡∞ï‡∞ø, ‡∞Æ‡∞∞‡∞ø‡∞Ø‡±Å `relay_off` ‡∞§‡±ã ‡∞Ü‡∞´‡±ç ‡∞ö‡±á‡∞Ø‡∞°‡∞æ‡∞®‡∞ø‡∞ï‡∞ø ‡∞Ü‡∞∂‡∞ø‡∞∏‡±ç‡∞§‡±Å‡∞Ç‡∞¶‡∞ø.

    > üíÅ ‡∞á‡∞¶‡∞ø ‡∞í‡∞ï‡±á ‡∞°‡±à‡∞∞‡±Ü‡∞ï‡±ç‡∞ü‡±ç ‡∞Æ‡±Ü‡∞•‡∞°‡±ç ‡∞∞‡∞ø‡∞ï‡±ç‡∞µ‡±Ü‡∞∏‡±ç‡∞ü‡±ç ‡∞≤‡±ã ‡∞ï‡±Ç‡∞°‡∞æ ‡∞Ö‡∞Æ‡∞≤‡±Å ‡∞ö‡±á‡∞Ø‡∞µ‡∞ö‡±ç‡∞ö‡±Å, ‡∞Ü ‡∞∞‡±Ä‡∞≤‡±á ‡∞Ø‡±ä‡∞ï‡±ç‡∞ï ‡∞ï‡∞æ‡∞µ‡∞≤‡∞∏‡∞ø‡∞® ‡∞™‡∞∞‡∞ø‡∞∏‡±ç‡∞•‡∞ø‡∞§‡∞ø‡∞®‡∞ø ‡∞Æ‡±Ü‡∞•‡∞°‡±ç ‡∞∞‡∞ø‡∞ï‡±ç‡∞µ‡±Ü‡∞∏‡±ç‡∞ü‡±ç ‡∞≤‡±ã ‡∞™‡∞æ‡∞∏‡±ç ‡∞Ö‡∞Ø‡±ç‡∞Ø‡±á ‡∞™‡±á‡∞ó‡±ç‡∞≤‡±ã‡∞°‡±ç ‡∞¶‡±ç‡∞µ‡∞æ‡∞∞‡∞æ ‡∞™‡∞Ç‡∞™‡∞°‡∞Ç ‡∞Æ‡∞∞‡∞ø‡∞Ø‡±Å `request` ‡∞Ü‡∞¨‡±ç‡∞ú‡±Ü‡∞ï‡±ç‡∞ü‡±Å ‡∞®‡±Å‡∞Ç‡∞°‡∞ø ‡∞Ö‡∞Ç‡∞¶‡±Å‡∞¨‡∞æ‡∞ü‡±Å‡∞≤‡±ã ‡∞â‡∞Ç‡∞ö‡∞°‡∞Ç.

1. ‡∞°‡±à‡∞∞‡±Ü‡∞ï‡±ç‡∞ü‡±ç ‡∞Æ‡±Ü‡∞•‡∞°‡±ç‚Äå‡∞≤‡±Å ‡∞π‡±ç‡∞Ø‡∞æ‡∞Ç‡∞°‡∞ø‡∞≤‡±ç ‡∞Ö‡∞Ø‡∞ø‡∞®‡∞ü‡±ç‡∞≤‡±Å ‡∞ï‡∞æ‡∞≤‡∞ø‡∞Ç‡∞ó‡±ç ‡∞ï‡±ã‡∞°‡±ç ‡∞ï‡∞ø ‡∞§‡±Ü‡∞≤‡∞ø‡∞Ø‡∞ú‡±á‡∞Ø‡∞°‡∞æ‡∞®‡∞ø‡∞ï‡∞ø ‡∞∏‡±ç‡∞™‡∞Ç‡∞¶‡∞® ‡∞Ö‡∞µ‡∞∏‡∞∞‡∞Ç. `handle_method_request` ‡∞´‡∞Ç‡∞ï‡±ç‡∞∑‡∞®‡±ç ‡∞ö‡∞ø‡∞µ‡∞∞ ‡∞ï‡±ç‡∞∞‡∞ø‡∞Ç‡∞¶‡∞ø ‡∞ï‡±ã‡∞°‡±ç ‡∞ú‡±ã‡∞°‡∞ø‡∞Ç‡∞ö‡∞Ç‡∞°‡∞ø, ‡∞á‡∞¶‡∞ø ‡∞∞‡∞ø‡∞ï‡±ç‡∞µ‡±Ü‡∞∏‡±ç‡∞ü‡±ç ‡∞ï‡±Å ‡∞∏‡±ç‡∞™‡∞Ç‡∞¶‡∞® ‡∞∏‡±É‡∞∑‡±ç‡∞ü‡∞ø‡∞∏‡±ç‡∞§‡±Å‡∞Ç‡∞¶‡∞ø:

    ```python
    method_response = MethodResponse.create_from_method_request(request, 200)
    device_client.send_method_response(method_response)
    ```

    ‡∞à ‡∞ï‡±ã‡∞°‡±ç HTTP ‡∞∏‡±ç‡∞ü‡±á‡∞ü‡∞∏‡±ç ‡∞ï‡±ã‡∞°‡±ç 200 ‡∞§‡±ã ‡∞°‡±à‡∞∞‡±Ü‡∞ï‡±ç‡∞ü‡±ç ‡∞Æ‡±Ü‡∞•‡∞°‡±ç ‡∞∞‡∞ø‡∞ï‡±ç‡∞µ‡±Ü‡∞∏‡±ç‡∞ü‡±ç ‡∞ï‡±Å ‡∞∏‡±ç‡∞™‡∞Ç‡∞¶‡∞® ‡∞™‡∞Ç‡∞™‡±Å‡∞§‡±Å‡∞Ç‡∞¶‡∞ø, ‡∞Æ‡∞∞‡∞ø‡∞Ø‡±Å ‡∞¶‡±Ä‡∞®‡±ç‡∞®‡∞ø IoT ‡∞π‡∞¨‡±ç ‡∞ï‡∞ø ‡∞§‡∞ø‡∞∞‡∞ø‡∞ó‡∞ø ‡∞™‡∞Ç‡∞™‡±Å‡∞§‡±Å‡∞Ç‡∞¶‡∞ø.

1. ‡∞à ‡∞´‡∞Ç‡∞ï‡±ç‡∞∑‡∞®‡±ç ‡∞®‡∞ø‡∞∞‡±ç‡∞µ‡∞ö‡∞® ‡∞ï‡∞ø‡∞Ç‡∞¶ ‡∞ï‡±ç‡∞∞‡∞ø‡∞Ç‡∞¶‡∞ø ‡∞ï‡±ã‡∞°‡±ç ‡∞ú‡±ã‡∞°‡∞ø‡∞Ç‡∞ö‡∞Ç‡∞°‡∞ø:

    ```python
    device_client.on_method_request_received = handle_method_request
    ```

    ‡∞à ‡∞ï‡±ã‡∞°‡±ç ‡∞°‡±à‡∞∞‡±Ü‡∞ï‡±ç‡∞ü‡±ç ‡∞Æ‡±Ü‡∞•‡∞°‡±ç ‡∞™‡∞ø‡∞≤‡∞µ‡∞¨‡∞°‡∞ø‡∞®‡∞™‡±ç‡∞™‡±Å‡∞°‡±Å `handle_method_request` ‡∞´‡∞Ç‡∞ï‡±ç‡∞∑‡∞®‡±ç ‡∞®‡±Å IoT ‡∞π‡∞¨‡±ç ‡∞ï‡±ç‡∞≤‡±à‡∞Ç‡∞ü‡±ç ‡∞ï‡∞ø ‡∞ï‡∞æ‡∞≤‡±ç ‡∞ö‡±á‡∞Ø‡∞Æ‡∞®‡∞ø ‡∞ö‡±Ü‡∞™‡±ç‡∞™‡±Å‡∞§‡±Å‡∞Ç‡∞¶‡∞ø.

> üíÅ ‡∞Æ‡±Ä‡∞∞‡±Å ‡∞à ‡∞ï‡±ã‡∞°‡±ç ‡∞®‡±Å [code/pi](../../../../../2-farm/lessons/4-migrate-your-plant-to-the-cloud/code/pi) ‡∞≤‡±á‡∞¶‡∞æ [code/virtual-device](../../../../../2-farm/lessons/4-migrate-your-plant-to-the-cloud/code/virtual-device) ‡∞´‡±ã‡∞≤‡±ç‡∞°‡∞∞‡±ç‡∞≤‡∞≤‡±ã ‡∞ö‡±Ç‡∞°‡∞µ‡∞ö‡±ç‡∞ö‡±Å.

üòÄ ‡∞Æ‡±Ä ‡∞Æ‡∞ü‡±ç‡∞ü‡∞ø ‡∞§‡±á‡∞Æ ‡∞∏‡±Ü‡∞®‡±ç‡∞∏‡∞æ‡∞∞‡±ç ‡∞™‡±ç‡∞∞‡±ã‡∞ó‡±ç‡∞∞‡∞æ‡∞Æ‡±ç ‡∞Æ‡±Ä IoT ‡∞π‡∞¨‡±ç ‡∞ï‡±Å ‡∞ï‡∞®‡±Ü‡∞ï‡±ç‡∞ü‡±ç ‡∞Ö‡∞Ø‡∞ø‡∞™‡±ã‡∞Ø‡∞ø‡∞Ç‡∞¶‡∞ø!

---

<!-- CO-OP TRANSLATOR DISCLAIMER START -->
**‡∞Ö‡∞∏‡±ç‡∞µ‡±Ä‡∞ï‡∞∞‡∞£ ‡∞™‡±ç‡∞∞‡∞ï‡∞ü‡∞®**:
‡∞à ‡∞™‡∞§‡±ç‡∞∞‡∞æ‡∞®‡±ç‡∞®‡∞ø AI ‡∞Ö‡∞®‡±Å‡∞µ‡∞æ‡∞¶ ‡∞∏‡±á‡∞µ [Co-op Translator](https://github.com/Azure/co-op-translator) ‡∞â‡∞™‡∞Ø‡±ã‡∞ó‡∞ø‡∞Ç‡∞ö‡∞ø ‡∞Ö‡∞®‡±Å‡∞µ‡∞¶‡∞ø‡∞Ç‡∞ö‡∞¨‡∞°‡∞ø‡∞Ç‡∞¶‡∞ø. ‡∞Æ‡±á‡∞Æ‡±Å ‡∞ñ‡∞ö‡±ç‡∞ö‡∞ø‡∞§‡∞§‡±ç‡∞µ‡∞æ‡∞®‡∞ø‡∞ï‡∞ø ‡∞Ø‡∞§‡±ç‡∞®‡∞ø‡∞Ç‡∞ö‡∞ø‡∞®‡∞™‡±ç‡∞™‡∞ü‡∞ø‡∞ï‡±Ä, ‡∞∏‡±ç‡∞µ‡∞Ø‡∞Ç‡∞ö‡∞æ‡∞≤‡∞ï ‡∞Ö‡∞®‡±Å‡∞µ‡∞æ‡∞¶‡∞æ‡∞≤‡∞≤‡±ã ‡∞§‡∞™‡±ç‡∞™‡±Å‡∞≤‡±Å ‡∞≤‡±á‡∞¶‡∞æ ‡∞Ö‡∞∏‡∞§‡±ç‡∞Ø‡∞§‡∞≤‡±Å ‡∞â‡∞Ç‡∞°‡∞µ‡∞ö‡±ç‡∞ö‡±Å. ‡∞ï‡±É‡∞§‡±ç‡∞∞‡∞ø‡∞Æ ‡∞≠‡∞æ‡∞∑‡∞≤‡±ã ‡∞â‡∞®‡±ç‡∞® ‡∞Ö‡∞∏‡∞≤‡±Å ‡∞™‡∞§‡±ç‡∞∞‡∞æ‡∞®‡±ç‡∞®‡∞ø ‡∞Ö‡∞ß‡∞ø‡∞ï‡∞æ‡∞∞‡∞ø‡∞ï ‡∞Æ‡±Ç‡∞≤‡∞Ç‡∞ó‡∞æ ‡∞™‡∞∞‡∞ø‡∞ó‡∞£‡∞ø‡∞Ç‡∞ö‡∞µ‡∞≤‡±Ü‡∞®‡±Å. ‡∞Æ‡±Å‡∞ñ‡±ç‡∞Ø‡∞Æ‡±à‡∞® ‡∞∏‡∞Æ‡∞æ‡∞ö‡∞æ‡∞∞‡∞Ç ‡∞ï‡±ã‡∞∏‡∞Ç, ‡∞™‡±ç‡∞∞‡±ä‡∞´‡±Ü‡∞∑‡∞®‡∞≤‡±ç ‡∞Æ‡∞æ‡∞®‡∞µ ‡∞Ö‡∞®‡±Å‡∞µ‡∞æ‡∞¶‡∞æ‡∞®‡±ç‡∞®‡∞ø ‡∞∏‡±Ç‡∞ö‡∞ø‡∞∏‡±ç‡∞§‡∞æ‡∞Æ‡±Å. ‡∞à ‡∞Ö‡∞®‡±Å‡∞µ‡∞æ‡∞¶‡∞Ç ‡∞â‡∞™‡∞Ø‡±ã‡∞ó‡∞Ç‡∞§‡±ã ‡∞è‡∞∞‡±ç‡∞™‡∞°‡∞ø‡∞® ‡∞à‡∞ü‡∞∞‡±Å‡∞µ‡±Å‡∞≤‡±Å ‡∞≤‡±á‡∞¶‡∞æ ‡∞§‡∞™‡±ç‡∞™‡±Å‡∞¨‡∞æ‡∞ü‡±ç‡∞≤ ‡∞ï‡±ã‡∞∏‡∞Ç ‡∞Æ‡±á‡∞Æ‡±Å ‡∞¨‡∞æ‡∞ß‡±ç‡∞Ø‡∞§ ‡∞µ‡∞π‡∞ø‡∞Ç‡∞ö‡∞Æ‡±Å.
<!-- CO-OP TRANSLATOR DISCLAIMER END -->