# เดธเดเดญเดพเดทเดฃเดคเตเดคเดฟเตฝ เดจเดฟเดจเตเดจเต เดฒเดฟเดชเดฟเดตเดฟเดตเดฐเดฃเด - เดฑเดพเดธเตเดฌเตเดฑเดฟ เดชเต

เดชเดพเดเดคเตเดคเดฟเดจเตเดฑเต เด เดญเดพเดเดคเตเดคเดฟเตฝ, เดเตเดฏเดพเดกเตเดเตผ เดเตเดฏเตโเดคเดฟเดฐเดฟเดเตเดเตเดจเตเดจ เดเดกเดฟเดฏเตเดฏเดฟเดฒเต เดธเดเดญเดพเดทเดฃเดคเตเดคเต เดเตเดเตเดธเตเดฑเตเดฑเดฟเดฒเดพเดเตเดเดฟ เดฎเดพเดฑเตเดฑเดพเตป เดธเตเดชเตเดเตเดเต เดธเตผเดตเตเดธเต เดเดชเดฏเตเดเดฟเดเตเดเต เดเตเดกเต เดเดดเตเดคเตเด.

## เดเดกเดฟเดฏเต เดธเตเดชเตเดเตเดเต เดธเตผเดตเตเดธเดฟเดฒเตเดเตเดเต เดเดฏเดฏเตเดเตเดเตเด

เดเดกเดฟเดฏเต เดธเตเดชเตเดเตเดเต เดธเตผเดตเตเดธเดฟเดฒเตเดเตเดเต REST API เดเดชเดฏเตเดเดฟเดเตเดเต เดเดฏเดฏเตเดเตเดเดพเตป เดเดดเดฟเดฏเตเด. เดธเตเดชเตเดเตเดเต เดธเตผเดตเตเดธเต เดเดชเดฏเตเดเดฟเดเตเดเดพเตป, เดเดฆเตเดฏเด เดเดเตเดธเดธเต เดเตเดเตเดเตบ เดเดญเตเดฏเตผเดคเตเดฅเดฟเดเตเดเดฃเด, เดคเตเดเตผเดจเตเดจเต เด เดเตเดเตเดเตบ เดเดชเดฏเตเดเดฟเดเตเดเต REST API เดเดเตเดธเดธเต เดเตเดฏเตเดฏเดฃเด. เด เดเดเตเดธเดธเต เดเตเดเตเดเดฃเตเดเตพ 10 เดฎเดฟเดจเดฟเดฑเตเดฑเต เดเดดเดฟเดเตเดเต เดเดพเดฒเดนเดฐเดฃเดชเตเดชเตเดเตเด, เดเดคเดฟเดจเดพเตฝ เดจเดฟเดเตเดเดณเตเดเต เดเตเดกเต เดเดต เดธเดพเดงเดพเดฐเดฃเดฏเดพเดฏเดฟ เดเดญเตเดฏเตผเดคเตเดฅเดฟเดเตเดเต เดฏเดฅเดพเดธเดฎเดฏเด เดชเตเดคเตเดเตเดเดพเตป เดเดฃเตเดเดพเดเดฃเด.

###เดเดพเดฐเตเดฏเตเดฏเด - เดเดเตเดธเดธเต เดเตเดเตเดเตบ เดจเตเดเตเด

1. เดจเดฟเดเตเดเดณเตเดเต เดชเตเดฏเดฟเตฝ `smart-timer` เดชเตเดฐเตเดเดเตเดฑเตเดฑเต เดคเตเดฑเดเตเดเตเด.

1. `play_audio` เดซเดเตเดทเตป เดจเตเดเตเดเด เดเตเดฏเตเดฏเตเด. เดเดจเดฟ เดเดคเต เดตเตเดฃเตเดเดฟเดฒเตเดฒ, เดเดพเดฐเดฃเด เดจเดฟเดเตเดเตพ เดชเดฑเดเตเดเดคเต เดตเตเดฃเตเดเตเด เดฎเดเดเตเดเดฟ เดชเดฑเดฏเตเดฃเตเด smart timer เดเดเตเดฐเดนเดฟเดเตเดเตเดจเตเดจเดฟเดฒเตเดฒ.

1. `app.py` เดซเดฏเดฒเดฟเดจเตเดฑเต เดฎเตเตฝเดญเดพเดเดคเตเดคเต เดคเดพเดดเต เดเดพเดฃเตเดจเตเดจ เดเดฎเตเดชเตเตผเดเตเดเต เดเตเตผเดเตเดเตเด:

    ```python
    import requests
    ```

1. `while True` เดฒเตเดชเดฟเดจเต เดฎเตเดฎเตเดชเต เดคเดพเดดเต เดเตเดเตเดคเตเดคเดฟเดฐเดฟเดเตเดเตเดจเตเดจ เดเตเดกเต เดเตเตผเดเตเดเตเด, เดธเตเดชเตเดเตเดเต เดธเตผเดตเตเดธเดฟเดจเตเดฑเต เดเดฟเดฒ เดธเตเดฑเตเดฑเดฟเดเดเตเดเตพ เดชเตเดฐเดเตเดฏเดพเดชเดฟเดเตเดเดพเตป:

    ```python
    speech_api_key = '<key>'
    location = '<location>'
    language = '<language>'
    ```

    `<key>` เดเดจเตเดจเดคเต เดจเดฟเดเตเดเดณเตเดเต เดธเตเดชเตเดเตเดเต เดธเตผเดตเตเดธเต เดฑเดฟเดธเตเดดเตโเดธเต เดเดชเดฟ เดเต เดเดฏเดฟ เดฎเดพเดฑเตเดฑเตเด. `<location>` เดเดจเตเดจเดคเต เดจเดฟเดเตเดเตพ เดธเตเดชเตเดเตเดเต เดธเตผเดตเตเดธเต เดฑเดฟเดธเตเดดเตโเดธเต เดธเตเดทเตเดเดฟเดเตเดเดคเดฟเดจเต เดเดชเดฏเตเดเดฟเดเตเด เดฒเตเดเตเดเตเดทเตป เดเดฏเดฟ เดฎเดพเดฑเตเดฑเตเด.

    `<language>` เดเดจเตเดจเดคเต เดจเดฟเดเตเดเดณเตเดเต เดธเดเดธเดพเดฐ เดญเดพเดทเดฏเตเดเต เดฒเตเดเตเดเตเตฝ เดจเดพเดฎเด เดเดฏเดฟ เดฎเดพเดฑเตเดฑเตเด, เดเดฆเดพเดนเดฐเดฃเดคเตเดคเดฟเดจเต เดเดเดเตเดฒเตเดทเต เดเดฏเตเดเตเดเดฟเตฝ `en-GB`, เดเดพเตปเดฑเตบเดธเตเดธเต เดเดฏเตเดเตเดเดฟเตฝ `zn-HK`. เดฎเตเดเตเดฐเตเดธเตเดซเตเดฑเตเดฑเต เดกเตเดเตโเดธเดฟเตฝ [เดญเดพเดทเดเดณเตเด เดตเตเดฏเตเดธเต เดชเดฟเดจเตเดคเตเดฃเดฏเตเด](https://docs.microsoft.com/azure/cognitive-services/speech-service/language-support?WT.mc_id=academic-17441-jabenn#speech-to-text) เดเดณเตเดณ เดชเดเตเดเดฟเดเดฏเดฟเตฝ เดจเดฟเดเตเดเตพเดเตเดเต เดธเตเดเดฐเตเดฏเดชเตเดฐเดฆเดฎเดพเดฏเดฟ เดชเตเดฐเดพเดชเตเดฏเดฎเดพเดเตเดเดพเด.

1. เดเดคเดฟเดจเต เดคเดพเดดเต, เดเดเตเดธเดธเต เดเตเดเตเดเตบ เดจเตเดเดพเดจเดพเดฏเดฟ เดคเดพเดดเต เดเดพเดฃเตเดจเตเดจ เดซเดเตเดทเตป เดเตเตผเดเตเดเตเด:

    ```python
    def get_access_token():
        headers = {
            'Ocp-Apim-Subscription-Key': speech_api_key
        }
    
        token_endpoint = f'https://{location}.api.cognitive.microsoft.com/sts/v1.0/issuetoken'
        response = requests.post(token_endpoint, headers=headers)
        return str(response.text)
    ```

    เดเดคเตเดฐเต เดเตเดเตเดเตบ เดเดฑเดเตเดเดฟเดตเดฏเตเดเตเดเตเดจเตเดจ เดเดจเตเดฑเตเดชเตเดฏเดฟเดจเตเดฑเดฟเตฝ API เดเต เดนเตเดกเดฑเดพเดฏเดฟ เดเตเตผเดคเตเดคเต เดตเดฟเดณเดฟเดเตเดเตเดจเตเดจเต. เดเดคเต เดธเตเดชเตเดเตเดเต เดธเตผเดตเตเดธเตเดเตพ เดตเดฟเดณเดฟเดเตเดเดพเตป เดเดชเดฏเตเดเดฟเดเตเดเตเดจเตเดจ เดเดเตเดธเดธเต เดเตเดเตเดเตบ เดจเตฝเดเตเด.

1. เดเดคเดฟเดจเต เดคเดพเดดเต, REST API เดเดชเดฏเตเดเดฟเดเตเดเต เดเตเดฏเดพเดกเตเดเตผ เดเตเดฏเตโเดคเดฟเดฐเดฟเดเตเดเตเดจเตเดจ เดเดกเดฟเดฏเตเดฏเดฟเดฒเต เดธเดเดญเดพเดทเดฃเด เดเตเดเตเดธเตเดฑเตเดฑเดฟเดฒเดพเดเตเดเดพเตป เดซเดเตเดทเตป เดชเตเดฐเดเตเดฏเดพเดชเดฟเดเตเดเตเด:

    ```python
    def convert_speech_to_text(buffer):
    ```

1. เด เดซเดเตเดทเดจเดฟเตฝ, REST API URL, เดนเตเดกเดฑเตเดเตพ เดธเดเตเดเดฎเดพเดเตเดเตเด:

    ```python
    url = f'https://{location}.stt.speech.microsoft.com/speech/recognition/conversation/cognitiveservices/v1'

    headers = {
        'Authorization': 'Bearer ' + get_access_token(),
        'Content-Type': f'audio/wav; codecs=audio/pcm; samplerate={rate}',
        'Accept': 'application/json;text/xml'
    }

    params = {
        'language': language
    }
    ```

    เดธเตเดชเตเดเตเดเต เดธเตผเดตเตเดธเต เดฑเดฟเดธเตเดดเตโเดธเดฟเดจเตเดฑเต เดฒเตเดเตเดเตเดทเตป เดเดชเดฏเตเดเดฟเดเตเดเต URL เดจเดฟเตผเดฎเดพเดฃเด เดเดฃเต เดเดคเต. `get_access_token` เดซเดเตเดทเดจเดฟเตฝ เดจเดฟเดจเตเดจเตเดณเตเดณ เดเดเตเดธเดธเต เดเตเดเตเดเตบ เดนเตเดกเดฑเตเดเดณเดฟเตฝ เดตเดฟเดจเตเดฏเดธเดฟเดเตเดเตเดจเตเดจเต, เดเตเดเดพเดคเต เดเดกเดฟเดฏเต เดเตเดฏเดพเดกเตเดเตผ เดเตเดฏเตเดฏเดพเตป เดเดชเดฏเตเดเดฟเดเตเด เดธเดพเดฎเตเดชเดฟเตพ เดฑเตเดฑเตเดฑเต เดเตเตผเดเตเดเตเดจเตเดจเต. เดเดตเดธเดพเดจเด URL-เตฝ เดญเดพเดท เดธเดเดฌเดจเตเดงเดฟเดเตเด เดชเดพเดฐเดพเดฎเตเดฑเตเดฑเดฑเตเดเดณเตเด เด เดตเดฟเดธเตเดคเตเดคเดฟเดฏเดฟเดฒเตเดณเตเดณ เดจเดฟเตผเดฎเตเดฎเดฟเดคเดฟเดฏเตเด เดจเดฟเตผเดตเดเดฟเดเตเดเตเดจเตเดจเต.

1. เดเดคเดฟเดจเต เดคเดพเดดเต, REST API เดตเดฟเดณเดฟเดเตเดเต เดเตเดเตเดธเตเดฑเตเดฑเต เดเดฑเตเดฑเตเดเตเดเตเดเดพเตป เดคเดพเดดเต เดเดพเดฃเตเดจเตเดจ เดเตเดกเต เดเตเตผเดเตเดเตเด:

    ```python
    response = requests.post(url, headers=headers, params=params, data=buffer)
    response_json = response.json()

    if response_json['RecognitionStatus'] == 'Success':
        return response_json['DisplayText']
    else:
        return ''
    ```

    เดเดคเต URL เดตเดฟเดณเดฟเดเตเดเต เดฎเดฑเตเดชเดเดฟ JSON เดกเดฟเดเตเดกเต เดเตเดฏเตเดฏเตเดจเตเดจเต. เดฎเดฑเตเดชเดเดฟ เดเดณเตเดณเดฟเตฝ `RecognitionStatus` เดฎเตเดฒเตเดฏเด เดตเตเดณเดฟเดชเตเดชเตเดเตเดคเตเดคเตเดจเตเดจเต เดเตเตพเดชเตเดชเตเดณเตเดณ เดธเดเดญเดพเดทเดฃเด เดตเดฟเดเดฏเดเดฐเดฎเดพเดฏเดฟ เดเตเดเตเดธเตเดฑเตเดฑเดพเดฏเดฟ เดฎเดพเดฑเตเดฑเดฟเดฏเดฟเดเตเดเตเดฃเตเดเต เดเดจเตเดจเต. เดเดคเต `Success` เดเดฃเตเดเตเดเดฟเตฝ เดเตเดเตเดธเตเดฑเตเดฑเต เดซเดเตเดทเดจเดฟเตฝ เดจเดฟเดจเตเดจเต เดฎเดเดเตเดเดฟ เดเตเดเตเดเตเดเตเดจเตเดจเต, เดเดฒเตเดฒเตเดเตเดเดฟเตฝ เดถเตเดจเตเดฏเดฎเดพเดเตเดเตเด.

1. `while True:` เดฒเตเดชเดฟเดจเต เดฎเตเดเดณเดฟเตฝ, เดธเตเดชเตเดเตเดเต เดเต เดเตเดเตเดธเตเดฑเตเดฑเต เดธเตผเดตเตเดธเดฟเตฝ เดจเดฟเดจเตเดจเตเดณเตเดณ เดเตเดเตเดธเตเดฑเตเดฑเต เดชเตเดฐเตเดธเดธเตเดธเต เดเตเดฏเตเดฏเดพเดจเตเดณเตเดณ เดซเดเตเดทเตป เดจเดฟเตผเดตเดเดฟเดเตเดเตเด. เดเดชเตเดชเตเตพ เดเดคเต ํ์คํธ เดเดฃเตเดเตเดฐเตเตพ เดเตเดฏเตเดฏเดพเดจเดพเดฏเดฟ เดฎเดพเดคเตเดฐเดฎเต เดเดชเดฏเตเดเดฟเดเตเดเต.

    ```python
    def process_text(text):
        print(text)
    ```

1. เดเตเดฑเดฟเดฏ `while True` เดฒเตเดชเดฟเตฝ `play_audio` เดตเดฟเดณเดฟเดชเตเดชเดฟเดเตเดเตเดจเตเดจเดคเต `convert_speech_to_text` เดซเดเตเดทเตป เดตเดฟเดณเดฟเดเตเดเต เดชเดฐเดฟเดธเตเดฅเดฟเดคเดฟ เดเตเดเตเดธเตเดฑเตเดฑเต `process_text` เดซเดเตเดทเดจเดฟเดฒเตเดเตเดเต เดจเตฝเดเตเดจเตเดจเดคเดฟเตฝ เดฎเดพเดฑเตเดฑเตเด:

    ```python
    text = convert_speech_to_text(buffer)
    process_text(text)
    ```

1. เดเตเดกเต เดฑเตบ เดเตเดฏเตเดฏเตเด. เดฌเดเตเดเตบ เดเดฎเตผเดคเตเดคเดฟ เดฎเตเดเตเดฐเตเดซเตเดฃเดฟเตฝ เดธเดเดธเดพเดฐเดฟเดเตเดเตเด. เดเดตเดธเดพเดจเดฟเดชเตเดชเดฟเดเตเดเดพเตฝ เดฌเดเตเดเตบ เดตเดฟเดเตเดเต เดเดกเดฟเดฏเต เดเตเดเตเดธเตเดฑเตเดฑเดฟเดฒเตเดเตเดเต เดฎเดพเดฑเตเดฑเดฟ เดเดฃเตเดเตเดฐเตเตพเดเตเดเต เดชเตเดฐเดฟเดจเตเดฑเต เดเตเดฏเตเดฏเตเด.

    ```output
    pi@raspberrypi:~/smart-timer $ python3 app.py 
    Hello world.
    Welcome to IoT for beginners.
    ```

    เดตเตเดฏเดคเตเดฏเดธเตเดค เดคเดฐเดคเตเดคเดฟเดฒเตเดณเตเดณ เดตเดพเดเตเดฏเดเตเดเตพ เดเดชเดฏเตเดเดฟเดเตเดเต เดถเตเดฐเดฎเดฟเดเตเดเตเด, เดเดฐเต เดชเตเดฒเตเดฏเตเดณเตเดณเดฐเดฟเดฏเดชเตเดชเตเดเตเด เดตเดพเดเตเดเตเดเตพ เดตเตเดฏเดคเตเดฏเดธเตเดค เดเตผเดคเตเดฅเด เดเดณเตเดณ เดตเดพเดเตเดฏเดเตเดเดณเดฟเดฒเตเด. เดเดฆเดพเดนเดฐเดฃเดคเตเดคเดฟเดจเต, เดเดเดเตเดฒเตเดทเดฟเตฝ เดธเดเดธเดพเดฐเดฟเดเตเดเตเดฎเตเดชเตเตพ 'I want to buy two bananas and an apple too' เดเดจเตเดจ เดตเดพเดเตเดฏเด เดชเดฑเดเตเดเต เดจเตเดเตเดเตเด, เดเตเดคเตเดฏเดฎเดพเดฏ 'to', 'two', 'too' เดเดชเดฏเตเดเดคเตเดคเดฟเดฒเต เดตเตเดฏเดคเตเดฏเดพเดธเด เดเตเดตเดฒเด เดถเดฌเตเดฆเด เดชเดฐเดฟเดเดฃเดฟเดเตเดเดพเดคเต เดตเดพเดเตเดเดฟเดจเตเดฑเต เดชเดถเตเดเดพเดคเตเดคเดฒเดคเตเดคเต เดเดเดฟเดธเตเดฅเดพเดจเดฎเดพเดเตเดเดฟ เดเดเตเดเดจเต เดตเตเดฃเตเดฏเตเดณเตเดณเดคเต เดเดชเดฏเตเดเดฟเดเตเดเตเดจเตเดจเตเดตเต เดเดจเตเดจเต เดถเตเดฐเดฆเตเดงเดฟเดเตเดเตเด.

> ๐ เด เดเตเดกเต [code-speech-to-text/pi](../../../../../6-consumer/lessons/1-speech-recognition/code-speech-to-text/pi) เดซเตเดณเดกเดฑเดฟเตฝ เดฒเดญเตเดฏเดฎเดพเดฃเต.

๐ เดจเดฟเดเตเดเดณเตเดเต เดธเดเดญเดพเดทเดฃเดคเตเดคเดฟเตฝ เดจเดฟเดจเตเดจเต เดฒเดฟเดชเดฟเดตเดฟเดตเดฐเดฃ เดชเตเดฐเตเดเตเดฐเดพเด เดตเดฟเดเดฏเดเดฐเดฎเดพเดฏเดฟ เดเดเตเดฐเต!

---

<!-- CO-OP TRANSLATOR DISCLAIMER START -->
**เดเดฑเตเดฑเดเดชเดฑเตเดฑเตเดจเตเดจ เดเดพเดฐเตเดฏเดเตเดเตพ**:  
เด เดชเตเดฐเดฎเดพเดฃเด AI เดตเดฟเดตเตผเดคเตเดคเดจ เดธเตเดตเดจเดฎเดพเดฏ [Co-op Translator](https://github.com/Azure/co-op-translator) เดเดชเดฏเตเดเดฟเดเตเดเต เดตเดฟเดตเตผเดคเตเดคเดจเด เดเตเดฏเตเดคเดคเดพเดฃเต. เดเดเตเดเตพ เดเตเดคเตเดฏเดคเดฏเตเดเตเดเดพเดฏเดฟ เดชเดฐเดฟเดถเตเดฐเดฎเดฟเดเตเดเตเดเตเดเดฟเดฒเตเด, เดธเตเดตเดฏเดเดเตเดคเดฎเดพเดฏ เดตเดฟเดตเตผเดคเตเดคเดจเดเตเดเดณเดฟเตฝ เดชเดฟเดดเดตเตเดเดณเตเด เดคเตเดฑเตเดฑเดพเดฏ เดตเดฟเดตเดฐเดเตเดเดณเตเด เดเดฃเตเดเดพเดเดพเดตเตเดจเตเดจเดคเดพเดฃเต. เดชเตเดฐเดพเดฅเดฎเดฟเด เดญเดพเดทเดฏเดฟเตฝ เดเดณเตเดณ เดฎเดพเดคเตเดชเตเดฐเดฎเดพเดฃเด เดเดฆเตเดฏเตเดเดฟเดเดฎเดพเดฏ เดธเตเดฐเตเดคเดธเดพเดฏเดฟ เดชเดฐเดฟเดเดฃเดฟเดเตเดเดฃเด. เดจเดฟเตผเดฃเดพเดฏเดเดฎเดพเดฏ เดตเดฟเดตเดฐเดเตเดเตพเดเตเดเดพเดฏเดฟ เดตเดฟเดฆเดเตเดง เดฎเดพเดจเดต เดตเดฟเดตเตผเดคเตเดคเดจเด เดจเดฟเตผเดฆเตเดฆเตเดถเดฟเดเตเดเตเดจเตเดจเต. เด เดตเดฟเดตเตผเดคเตเดคเดจเดคเตเดคเต เดเดถเตเดฐเดฏเดฟเดเตเดเตเดตเดจเตเดจเตเดเดฃเตเดเดพเดเดพเดจเตเดณเตเดณ เดเดคเตเดจเตเดคเต เดคเตเดฑเตเดฑเดพเดฏ เดตเตเดฏเดพเดเตเดฏเดพเดจเดเตเดเตพเดเตเดเตเด เดเดเตเดเตพ เดเดคเตเดคเดฐเดตเดพเดฆเดฟเดคเตเดตเดฎเดฟเดฒเตเดฒ.
<!-- CO-OP TRANSLATOR DISCLAIMER END -->